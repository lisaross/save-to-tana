{"version":3,"file":"content.js","sources":["../src/content.ts"],"sourcesContent":["/**\n * Content script interfaces\n */\ninterface ExtractOptions {\n  includeContent: boolean;\n  includeTitle: boolean;\n}\n\ninterface ExtractRequest {\n  action: 'extractContent';\n  options: ExtractOptions;\n}\n\ninterface ShowNotesDialogRequest {\n  action: 'showNotesDialog';\n}\n\n\ninterface PageData {\n  url: string;\n  title: string;\n  author: string;\n  description: string;\n  content: string;\n  error?: boolean;\n  message?: string;\n}\n\ntype ContentScriptRequest = ExtractRequest | ShowNotesDialogRequest;\n\n/**\n * Content script - extracts content from the current page\n */\n\n/**\n * Global state for overlay management\n */\nlet overlayElement: HTMLElement | null = null;\nlet currentPageData: PageData | null = null;\n\n// Listen for messages from the popup and background script\nchrome.runtime.onMessage.addListener((\n  request: ContentScriptRequest,\n  sender: chrome.runtime.MessageSender,\n  sendResponse: (response: any) => void\n) => {\n  console.log('Content script received message:', request.action);\n\n  if (request.action === 'extractContent') {\n    const options = request.options || { includeContent: true, includeTitle: true };\n    \n    try {\n      // Extract page information\n      const pageData: PageData = {\n        url: window.location.href,\n        title: document.title,\n        author: extractAuthor(),\n        description: extractDescription(),\n        content: ''\n      };\n      \n      // Extract content if requested\n      if (options.includeContent) {\n        pageData.content = extractMainContent();\n      }\n      \n      // If title is not requested, use URL as title\n      if (!options.includeTitle || !pageData.title) {\n        pageData.title = pageData.url;\n      }\n      \n      // Pre-sanitize title to avoid API errors\n      if (pageData.title) {\n        pageData.title = pageData.title.replace(/\\r?\\n|\\r/g, ' ').trim();\n      }\n      \n      sendResponse(pageData);\n    } catch (error) {\n      console.error('Content extraction error:', error);\n      sendResponse({\n        url: window.location.href,\n        title: document.title,\n        author: '',\n        description: '',\n        content: '',\n        error: true,\n        message: error instanceof Error ? error.message : 'Unknown error occurred during content extraction'\n      });\n    }\n  }\n\n  if (request.action === 'showNotesDialog') {\n    try {\n      // Extract current page data\n      const pageData: PageData = {\n        url: window.location.href,\n        title: document.title,\n        author: extractAuthor(),\n        description: extractDescription(),\n        content: extractMainContent()\n      };\n      \n      currentPageData = pageData;\n      showOverlay(pageData);\n      sendResponse({ success: true });\n    } catch (error) {\n      console.error('Error showing notes dialog:', error);\n      sendResponse({ \n        success: false, \n        error: error instanceof Error ? error.message : 'Failed to show notes dialog' \n      });\n    }\n  }\n\n  \n  // Must return true for asynchronous response\n  return true;\n});\n\n/**\n * Extract the main content from the page\n * @returns The main content text\n */\nfunction extractMainContent(): string {\n  // Get main content - prioritize article content, then main, then body\n  const mainElement = document.querySelector('article') || \n                     document.querySelector('main') || \n                     document.querySelector('.main-content') || \n                     document.body;\n  \n  if (!mainElement) {\n    return '';\n  }\n  \n  // Extract content\n  let content = mainElement.innerText;\n  \n  // Cap at 100000 characters to prevent excessive data transfer\n  const MAX_CONTENT_LENGTH = 100000;\n  if (content.length > MAX_CONTENT_LENGTH) {\n    content = content.substring(0, MAX_CONTENT_LENGTH) + \n              '... (content truncated due to very large page)';\n  }\n  \n  return content;\n}\n\n/**\n * Extract author from meta tags and common page elements\n * @returns The extracted author or empty string if not found\n */\nfunction extractAuthor(): string {\n  // Try various meta tags that might contain author information\n  const authorSelectors = [\n    'meta[name=\"author\"]',\n    'meta[property=\"article:author\"]',\n    'meta[name=\"twitter:creator\"]',\n    'meta[property=\"og:site_name\"]'\n  ];\n  \n  for (const selector of authorSelectors) {\n    const metaTag = document.querySelector(selector);\n    if (metaTag && metaTag.getAttribute('content')) {\n      return metaTag.getAttribute('content') || '';\n    }\n  }\n  \n  // Try schema.org markup\n  const schemaSelectors = [\n    '[itemtype*=\"schema.org/Person\"] [itemprop=\"name\"]',\n    '[itemtype*=\"schema.org/Organization\"] [itemprop=\"name\"]'\n  ];\n  \n  for (const selector of schemaSelectors) {\n    const element = document.querySelector(selector);\n    if (element && element.textContent) {\n      return element.textContent.trim();\n    }\n  }\n  \n  // Try byline classes commonly used\n  const bylineSelectors = ['.byline', '.author', '.article-author'];\n  \n  for (const selector of bylineSelectors) {\n    const element = document.querySelector(selector);\n    if (element && element.textContent) {\n      return element.textContent.trim();\n    }\n  }\n  \n  return '';\n}\n\n/**\n * Extract description from meta tags\n * @returns The extracted description or empty string if not found\n */\nfunction extractDescription(): string {\n  // Try various meta tags that might contain description\n  const descriptionSelectors = [\n    'meta[name=\"description\"]',\n    'meta[property=\"og:description\"]',\n    'meta[name=\"twitter:description\"]'\n  ];\n  \n  for (const selector of descriptionSelectors) {\n    const metaTag = document.querySelector(selector);\n    if (metaTag && metaTag.getAttribute('content')) {\n      return metaTag.getAttribute('content') || '';\n    }\n  }\n  \n  return '';\n}\n\n/**\n * Show the quick capture overlay\n */\nfunction showOverlay(pageData: PageData): void {\n  try {\n    // Remove existing overlay if present\n    hideOverlay();\n\n    // Create overlay container\n    overlayElement = document.createElement('div');\n    overlayElement.id = 'tana-save-overlay';\n    \n    // Apply overlay styles and HTML\n    overlayElement.innerHTML = getOverlayHTML(pageData);\n    \n    // Inject overlay styles\n    injectOverlayStyles();\n    \n    // Add to DOM - ensure we have a body element\n    if (!document.body) {\n      console.error('Cannot show overlay: document.body is not available');\n      return;\n    }\n    \n    document.body.appendChild(overlayElement);\n    \n    // Set up event listeners\n    setupOverlayEventListeners();\n    \n    // Focus on the notes textarea\n    setTimeout(() => {\n      const notesTextarea = overlayElement?.querySelector('#tana-notes-input') as HTMLTextAreaElement;\n      if (notesTextarea) {\n        notesTextarea.focus();\n      }\n    }, 100);\n    \n    console.log('Tana overlay shown successfully');\n  } catch (error) {\n    console.error('Error showing overlay:', error);\n    // Clean up on error\n    hideOverlay();\n  }\n}\n\n/**\n * Hide the quick capture overlay\n */\nfunction hideOverlay(): void {\n  if (overlayElement) {\n    // Clean up event listeners\n    document.removeEventListener('keydown', handleOverlayKeydown, true);\n    \n    overlayElement.remove();\n    overlayElement = null;\n    currentPageData = null;\n  }\n  \n  // Also remove the styles element\n  const styleElement = document.getElementById('tana-overlay-styles');\n  if (styleElement) {\n    styleElement.remove();\n  }\n}\n\n/**\n * Generate the overlay HTML\n */\nfunction getOverlayHTML(pageData: PageData): string {\n  const truncatedTitle = pageData.title.length > 60 \n    ? pageData.title.substring(0, 60) + '...' \n    : pageData.title;\n    \n  const truncatedUrl = pageData.url.length > 50 \n    ? pageData.url.substring(0, 50) + '...' \n    : pageData.url;\n\n  return `\n    <div class=\"tana-overlay-backdrop\">\n      <div class=\"tana-overlay-dialog\">\n        <div class=\"tana-overlay-header\">\n          <h2>Save to Tana</h2>\n          <button type=\"button\" class=\"tana-overlay-close\" id=\"tana-close-overlay\">\n            <svg width=\"18\" height=\"18\" viewBox=\"0 0 18 18\" fill=\"none\">\n              <path d=\"M13.5 4.5l-9 9M4.5 4.5l9 9\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\"/>\n            </svg>\n          </button>\n        </div>\n        \n        <div class=\"tana-overlay-content\">\n          <div class=\"tana-overlay-preview\">\n            <div class=\"tana-overlay-page-info\">\n              <div class=\"tana-overlay-page-title\">${escapeHtml(truncatedTitle)}</div>\n              <div class=\"tana-overlay-page-url\">${escapeHtml(truncatedUrl)}</div>\n            </div>\n          </div>\n          \n          <div class=\"tana-overlay-notes-section\">\n            <label for=\"tana-notes-input\" class=\"tana-overlay-label\">\n              Add notes (optional)\n            </label>\n            <textarea \n              id=\"tana-notes-input\" \n              class=\"tana-overlay-notes-input\" \n              placeholder=\"Add your notes here...\"\n              rows=\"4\"\n            ></textarea>\n          </div>\n          \n          <div class=\"tana-overlay-actions\">\n            <button type=\"button\" class=\"tana-overlay-button tana-overlay-button-secondary\" id=\"tana-cancel-save\">\n              Cancel\n            </button>\n            <button type=\"button\" class=\"tana-overlay-button tana-overlay-button-primary\" id=\"tana-confirm-save\">\n              Save to Tana\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  `;\n}\n\n/**\n * Inject CSS styles for the overlay\n */\nfunction injectOverlayStyles(): void {\n  // Check if styles are already injected\n  if (document.getElementById('tana-overlay-styles')) {\n    return;\n  }\n\n  const styleElement = document.createElement('style');\n  styleElement.id = 'tana-overlay-styles';\n  styleElement.textContent = `\n    #tana-save-overlay {\n      position: fixed !important;\n      top: 0 !important;\n      left: 0 !important;\n      width: 100% !important;\n      height: 100% !important;\n      z-index: 2147483647 !important;\n      font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", \"Liberation Sans\", Arial, sans-serif !important;\n      font-size: 14px !important;\n      line-height: 1.5 !important;\n      color: #c9d1d9 !important;\n      box-sizing: border-box !important;\n      pointer-events: auto !important;\n    }\n    \n    #tana-save-overlay * {\n      box-sizing: border-box !important;\n    }\n    \n    .tana-overlay-backdrop {\n      position: absolute !important;\n      top: 0 !important;\n      left: 0 !important;\n      width: 100% !important;\n      height: 100% !important;\n      background: rgba(0, 0, 0, 0.8) !important;\n      display: flex !important;\n      align-items: center !important;\n      justify-content: center !important;\n      padding: 20px !important;\n      box-sizing: border-box !important;\n    }\n    \n    .tana-overlay-dialog {\n      background: #161b22 !important;\n      border: 1px solid #30363d !important;\n      border-radius: 12px !important;\n      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5) !important;\n      width: 100% !important;\n      max-width: 540px !important;\n      max-height: 90vh !important;\n      overflow: hidden !important;\n      display: flex !important;\n      flex-direction: column !important;\n      position: relative !important;\n    }\n    \n    .tana-overlay-header {\n      display: flex !important;\n      align-items: center !important;\n      justify-content: space-between !important;\n      padding: 20px 24px 16px 24px !important;\n      border-bottom: 1px solid #30363d !important;\n      background: #0d1117 !important;\n    }\n    \n    .tana-overlay-header h2 {\n      margin: 0 !important;\n      font-size: 18px !important;\n      font-weight: 600 !important;\n      color: #f0f6fc !important;\n    }\n    \n    .tana-overlay-close {\n      background: transparent !important;\n      border: none !important;\n      color: #8b949e !important;\n      cursor: pointer !important;\n      padding: 8px !important;\n      border-radius: 6px !important;\n      display: flex !important;\n      align-items: center !important;\n      justify-content: center !important;\n      transition: all 0.2s !important;\n      margin: 0 !important;\n    }\n    \n    .tana-overlay-close:hover {\n      background: #21262d !important;\n      color: #f0f6fc !important;\n    }\n    \n    .tana-overlay-content {\n      flex: 1 !important;\n      overflow-y: auto !important;\n      padding: 24px !important;\n    }\n    \n    .tana-overlay-preview {\n      margin-bottom: 20px !important;\n      padding: 16px !important;\n      background: #0d1117 !important;\n      border: 1px solid #30363d !important;\n      border-radius: 8px !important;\n    }\n    \n    .tana-overlay-page-info {\n      display: flex !important;\n      flex-direction: column !important;\n      gap: 6px !important;\n    }\n    \n    .tana-overlay-page-title {\n      font-weight: 600 !important;\n      color: #f0f6fc !important;\n      font-size: 15px !important;\n      line-height: 1.4 !important;\n    }\n    \n    .tana-overlay-page-url {\n      color: #8b949e !important;\n      font-size: 13px !important;\n      word-break: break-all !important;\n    }\n    \n    .tana-overlay-notes-section {\n      margin-bottom: 24px !important;\n    }\n    \n    .tana-overlay-label {\n      display: block !important;\n      margin-bottom: 8px !important;\n      font-weight: 500 !important;\n      color: #c9d1d9 !important;\n      font-size: 14px !important;\n    }\n    \n    .tana-overlay-notes-input {\n      width: 100% !important;\n      background: #0d1117 !important;\n      color: #c9d1d9 !important;\n      border: 1px solid #30363d !important;\n      border-radius: 6px !important;\n      padding: 12px !important;\n      font-size: 14px !important;\n      line-height: 1.5 !important;\n      font-family: inherit !important;\n      resize: vertical !important;\n      min-height: 100px !important;\n      box-sizing: border-box !important;\n      transition: border-color 0.2s !important;\n    }\n    \n    .tana-overlay-notes-input:focus {\n      outline: none !important;\n      border-color: #8b949e !important;\n      box-shadow: 0 0 0 2px rgba(139, 148, 158, 0.3) !important;\n    }\n    \n    .tana-overlay-notes-input::placeholder {\n      color: #6e7681 !important;\n    }\n    \n    .tana-overlay-actions {\n      display: flex !important;\n      gap: 12px !important;\n      justify-content: flex-end !important;\n    }\n    \n    .tana-overlay-button {\n      border: none !important;\n      border-radius: 6px !important;\n      padding: 8px 16px !important;\n      font-size: 14px !important;\n      font-weight: 500 !important;\n      cursor: pointer !important;\n      transition: all 0.2s !important;\n      display: inline-flex !important;\n      align-items: center !important;\n      justify-content: center !important;\n      gap: 8px !important;\n      font-family: inherit !important;\n      line-height: 1.5 !important;\n      margin: 0 !important;\n    }\n    \n    .tana-overlay-button-secondary {\n      background: #21262d !important;\n      color: #f0f6fc !important;\n      border: 1px solid #30363d !important;\n    }\n    \n    .tana-overlay-button-secondary:hover {\n      background: #30363d !important;\n      border-color: #8b949e !important;\n    }\n    \n    .tana-overlay-button-primary {\n      background: #238636 !important;\n      color: #ffffff !important;\n      border: 1px solid #238636 !important;\n    }\n    \n    .tana-overlay-button-primary:hover {\n      background: #2ea043 !important;\n      border-color: #2ea043 !important;\n    }\n    \n    .tana-overlay-button-primary:disabled {\n      background: #21262d !important;\n      color: #6e7681 !important;\n      border-color: #30363d !important;\n      cursor: not-allowed !important;\n    }\n    \n    /* Toast notifications */\n    .tana-overlay-toast {\n      position: fixed !important;\n      top: 24px !important;\n      right: 24px !important;\n      background: #21262d !important;\n      color: #f0f6fc !important;\n      border: 1px solid #30363d !important;\n      border-radius: 8px !important;\n      padding: 12px 16px !important;\n      font-size: 14px !important;\n      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3) !important;\n      z-index: 2147483648 !important;\n      opacity: 0 !important;\n      transform: translateY(-8px) !important;\n      transition: all 0.3s ease !important;\n      pointer-events: none !important;\n      font-family: inherit !important;\n      max-width: 320px !important;\n    }\n    \n    .tana-overlay-toast.show {\n      opacity: 1 !important;\n      transform: translateY(0) !important;\n      pointer-events: auto !important;\n    }\n    \n    .tana-overlay-toast.success {\n      background: #1a7f37 !important;\n      color: #ffffff !important;\n      border-color: #238636 !important;\n    }\n    \n    .tana-overlay-toast.error {\n      background: #b62324 !important;\n      color: #ffffff !important;\n      border-color: #da3633 !important;\n    }\n    \n    /* Responsive adjustments */\n    @media (max-width: 600px) {\n      .tana-overlay-backdrop {\n        padding: 12px !important;\n      }\n      \n      .tana-overlay-dialog {\n        max-width: 100% !important;\n        margin: 0 !important;\n      }\n      \n      .tana-overlay-content {\n        padding: 20px !important;\n      }\n      \n      .tana-overlay-actions {\n        flex-direction: column !important;\n        gap: 8px !important;\n      }\n      \n      .tana-overlay-button {\n        width: 100% !important;\n      }\n    }\n  `;\n  \n  document.head.appendChild(styleElement);\n}\n\n/**\n * Set up event listeners for overlay interactions\n */\nfunction setupOverlayEventListeners(): void {\n  if (!overlayElement) return;\n\n  try {\n    // Close overlay handlers\n    const closeButton = overlayElement.querySelector('#tana-close-overlay');\n    const cancelButton = overlayElement.querySelector('#tana-cancel-save');\n    const backdrop = overlayElement.querySelector('.tana-overlay-backdrop');\n\n    if (closeButton) {\n      closeButton.addEventListener('click', hideOverlay);\n    }\n    \n    if (cancelButton) {\n      cancelButton.addEventListener('click', hideOverlay);\n    }\n    \n    if (backdrop) {\n      backdrop.addEventListener('click', (e) => {\n        if (e.target === backdrop) {\n          hideOverlay();\n        }\n      });\n    }\n\n    // Save button handler\n    const saveButton = overlayElement.querySelector('#tana-confirm-save');\n    if (saveButton) {\n      saveButton.addEventListener('click', handleSaveFromOverlay);\n    }\n\n    // Keyboard shortcuts\n    document.addEventListener('keydown', handleOverlayKeydown, true);\n  } catch (error) {\n    console.error('Error setting up overlay event listeners:', error);\n  }\n}\n\n/**\n * Handle save action from overlay\n */\nfunction handleSaveFromOverlay(): void {\n  if (!currentPageData || !overlayElement) return;\n\n  const notesInput = overlayElement.querySelector('#tana-notes-input') as HTMLTextAreaElement;\n  const notes = notesInput ? notesInput.value.trim() : '';\n\n  // Combine notes with content if provided\n  let finalContent = currentPageData.content;\n  if (notes) {\n    finalContent = notes + '\\n\\n' + finalContent;\n  }\n\n  const saveData = {\n    ...currentPageData,\n    content: finalContent,\n    notes\n  };\n\n  // Disable save button\n  const saveButton = overlayElement.querySelector('#tana-confirm-save') as HTMLButtonElement;\n  if (saveButton) {\n    saveButton.disabled = true;\n    saveButton.textContent = 'Saving...';\n  }\n\n  // Send save request\n  chrome.runtime.sendMessage({\n    action: 'saveToTana',\n    data: saveData\n  }, (response) => {\n    if (response && response.success) {\n      hideOverlay();\n      showToast('Page saved to Tana successfully!', 'success');\n    } else {\n      // Re-enable save button on error\n      if (saveButton) {\n        saveButton.disabled = false;\n        saveButton.textContent = 'Save to Tana';\n      }\n      showToast(response?.error || 'Save failed', 'error');\n    }\n  });\n}\n\n/**\n * Handle keyboard shortcuts in overlay\n */\nfunction handleOverlayKeydown(e: KeyboardEvent): void {\n  if (!overlayElement) return;\n\n  // Escape key closes overlay\n  if (e.key === 'Escape') {\n    e.preventDefault();\n    e.stopPropagation();\n    hideOverlay();\n  }\n\n  // Ctrl/Cmd + Enter saves\n  if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {\n    e.preventDefault();\n    e.stopPropagation();\n    handleSaveFromOverlay();\n  }\n}\n\n/**\n * Show a toast notification\n */\nfunction showToast(message: string, type: 'success' | 'error' = 'success'): void {\n  // Remove existing toast\n  const existingToast = document.querySelector('.tana-overlay-toast');\n  if (existingToast) {\n    existingToast.remove();\n  }\n\n  const toast = document.createElement('div');\n  toast.className = `tana-overlay-toast ${type}`;\n  toast.textContent = message;\n  \n  document.body.appendChild(toast);\n  \n  // Show toast\n  setTimeout(() => {\n    toast.classList.add('show');\n  }, 10);\n  \n  // Hide toast after 3 seconds\n  setTimeout(() => {\n    toast.classList.remove('show');\n    setTimeout(() => {\n      if (toast.parentNode) {\n        toast.remove();\n      }\n    }, 300);\n  }, 3000);\n}\n\n/**\n * Escape HTML characters\n */\nfunction escapeHtml(text: string): string {\n  const div = document.createElement('div');\n  div.textContent = text;\n  return div.innerHTML;\n}\n\n/**\n * Clean up overlay when page unloads\n */\nwindow.addEventListener('beforeunload', () => {\n  hideOverlay();\n  document.removeEventListener('keydown', handleOverlayKeydown, true);\n});\n"],"names":["overlayElement","currentPageData","request","sender","sendResponse","options","pageData","extractAuthor","extractDescription","extractMainContent","error","showOverlay","mainElement","content","MAX_CONTENT_LENGTH","authorSelectors","selector","metaTag","schemaSelectors","element","bylineSelectors","descriptionSelectors","hideOverlay","getOverlayHTML","injectOverlayStyles","setupOverlayEventListeners","notesTextarea","handleOverlayKeydown","styleElement","truncatedTitle","truncatedUrl","escapeHtml","closeButton","cancelButton","backdrop","e","saveButton","handleSaveFromOverlay","notesInput","notes","finalContent","saveData","response","showToast","message","type","existingToast","toast","text","div"],"mappings":"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"}