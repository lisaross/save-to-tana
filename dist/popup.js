class s{saveButton;statusDiv;openOptionsLink;includeContentCheckbox;includeTitleCheckbox;notConfiguredDiv;constructor(){this.saveButton=document.getElementById("save-button"),this.statusDiv=document.getElementById("status"),this.openOptionsLink=document.getElementById("open-options"),this.includeContentCheckbox=document.getElementById("include-content"),this.includeTitleCheckbox=document.getElementById("include-title"),this.notConfiguredDiv=document.getElementById("not-configured"),this.initializePopup()}initializePopup(){this.checkConfiguration(),this.openOptionsLink.addEventListener("click",this.openOptions.bind(this)),this.saveButton.addEventListener("click",this.saveToTana.bind(this))}checkConfiguration(){chrome.storage.sync.get(["apiKey","supertagId","targetNodeId"],e=>{(!e.apiKey||!e.supertagId||!e.targetNodeId)&&(this.saveButton.disabled=!0,this.notConfiguredDiv.style.display="block")})}openOptions(){chrome.runtime.openOptionsPage()}saveToTana(){this.saveButton.disabled=!0,this.saveButton.textContent="Saving...",this.updateStatus({message:"",isError:!1});const e={includeContent:this.includeContentCheckbox.checked,includeTitle:this.includeTitleCheckbox.checked};chrome.tabs.query({active:!0,currentWindow:!0},n=>{const t=n[0];if(!t||typeof t.id!="number"){this.handleError("Cannot access the current tab.");return}this.extractContentFromPage(t.id,e)})}extractContentFromPage(e,n){chrome.tabs.sendMessage(e,{action:"extractContent",options:n},t=>{if(chrome.runtime.lastError){this.handleError(`Error communicating with the page: ${chrome.runtime.lastError.message}`);return}if(!t){this.handleError("No response from the page. Please refresh and try again.");return}if(t.error){this.handleError(t.message||"Error extracting content from the page");return}this.sendToBackground(t)})}sendToBackground(e){const n={action:"saveToTana",data:e};chrome.runtime.sendMessage(n,t=>{if(chrome.runtime.lastError){this.handleError(`Error sending request: ${chrome.runtime.lastError.message}`);return}if(this.saveButton.disabled=!1,this.saveButton.textContent="Save to Tana",!t){this.handleError("No response from the extension. Please try again.");return}if(!t.success){this.handleError(t.error||"Unknown error occurred");return}this.showSuccess("Saved to Tana successfully!")})}handleError(e){this.saveButton.disabled=!1,this.saveButton.textContent="Save to Tana",this.updateStatus({message:e,isError:!0})}showSuccess(e){this.updateStatus({message:e,isError:!1}),setTimeout(()=>{this.updateStatus({message:"",isError:!1})},3e3)}updateStatus(e){this.statusDiv.textContent=e.message,this.statusDiv.className=`status${e.isError?" error":e.message?" success":""}`}}document.addEventListener("DOMContentLoaded",()=>{new s});
//# sourceMappingURL=popup.js.map
