class s{saveButton;statusDiv;openOptionsLink;includeContentCheckbox;includeTitleCheckbox;notConfiguredDiv;constructor(){this.saveButton=document.getElementById("save-button"),this.statusDiv=document.getElementById("status"),this.openOptionsLink=document.getElementById("open-options"),this.includeContentCheckbox=document.getElementById("include-content"),this.includeTitleCheckbox=document.getElementById("include-title"),this.notConfiguredDiv=document.getElementById("not-configured"),this.initializePopup()}initializePopup(){this.checkConfiguration(),this.openOptionsLink.addEventListener("click",this.openOptions.bind(this)),this.saveButton.addEventListener("click",this.saveToTana.bind(this))}checkConfiguration(){chrome.storage.sync.get(["apiKey","supertagId","targetNodeId"],t=>{(!t.apiKey||!t.supertagId||!t.targetNodeId)&&(this.saveButton.disabled=!0,this.notConfiguredDiv.style.display="block")})}openOptions(){chrome.runtime.openOptionsPage()}saveToTana(){this.saveButton.disabled=!0,this.saveButton.textContent="Saving...",this.updateStatus({message:"",isError:!1});const t={includeContent:this.includeContentCheckbox.checked,includeTitle:this.includeTitleCheckbox.checked};chrome.tabs.query({active:!0,currentWindow:!0},n=>{const e=n[0];if(!e.id){this.handleError("Cannot access the current tab.");return}this.extractContentFromPage(e.id,t)})}extractContentFromPage(t,n){chrome.tabs.sendMessage(t,{action:"extractContent",options:n},e=>{if(chrome.runtime.lastError){this.handleError("Error communicating with the page: "+chrome.runtime.lastError.message);return}if(!e){this.handleError("No response from the page. Please refresh and try again.");return}if(e.error){this.handleError(e.message||"Error extracting content from the page");return}this.sendToBackground(e)})}sendToBackground(t){const n={action:"saveToTana",data:t};chrome.runtime.sendMessage(n,e=>{if(this.saveButton.disabled=!1,this.saveButton.textContent="Save to Tana",!e){this.handleError("No response from the extension. Please try again.");return}if(!e.success){this.handleError(e.error||"Unknown error occurred");return}this.showSuccess("Saved to Tana successfully!")})}handleError(t){this.saveButton.disabled=!1,this.saveButton.textContent="Save to Tana",this.updateStatus({message:t,isError:!0})}showSuccess(t){this.updateStatus({message:t,isError:!1}),setTimeout(()=>{this.updateStatus({message:"",isError:!1})},3e3)}updateStatus(t){this.statusDiv.textContent=t.message,this.statusDiv.className="status"+(t.isError?" error":t.message?" success":"")}}document.addEventListener("DOMContentLoaded",()=>{new s});
//# sourceMappingURL=popup.js.map
